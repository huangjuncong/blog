---
title: JAVA 8å…¥é—¨ï¼ˆä¸€ï¼‰Lambdaè¡¨è¾¾å¼
date: 2017-10-24 19:09:08
tags: [java,Java 8,Lambda]
---

æœºæˆ¿è¿ç§»ä»¥åç»ˆäºå¯ä»¥ç”¨ä¸Š `Java 8`äº†ï¼Œæœ¬æ•™ç¨‹å°†ä¼šåˆ†ä¸ºä¸‰ä¸ªæ–¹é¢ä»‹ç»`Java 8` çš„æ–°ç‰¹æ€§ã€‚é¦–å…ˆç»™å¤§å®¶ä»‹ç» `Java 8` çš„Lambda è¡¨è¾¾å¼ã€‚

<!--more-->

## 1. è®©ä»£ç æ›´çµæ´»
ä½œä¸ºç¨‹åºå‘˜ï¼Œæ¯å¤©é™¤äº†å†™ä»£ç ï¼Œæœ€é‡è¦çš„äº‹æƒ…å°±æ˜¯åƒé¥­äº†ï¼Œä¸ºäº†åƒé¥­ï¼Œæˆ‘ä»¬è®¾è®¡äº†ä¸€ä¸ªDish å¯¹è±¡ï¼Œä»£ç å¦‚ä¸‹ï¼š

```java
public class Dish {

    private final String name;
    private final boolean vegetarian;
    private final int calories;
    private final Type type;
    
    public enum Type {MEAT,FISH,OTHER}
    
    //çœç•¥get setæ–¹æ³•
}
```

ä½œä¸ºä¸€ä¸ªå‡è‚¥äººå£«ï¼Œå¯»æ±‚åŒ»ç”Ÿå»ºè®®ã€‚åŒ»ç”Ÿè¯´ï¼Œä½å¡è·¯é‡Œé¥®é£Ÿï¼Œæ¯”è¾ƒå¥åº·ï¼Œä¸ºäº†æ‰¾å‡ºå¡è·¯é‡Œä½äº1000çš„èœå“ã€‚äºæ˜¯å°±æœ‰äº†ä¸€ä¸‹ä»£ç ï¼š

```java
public static List<Dish> filterDish(List<Dish> dishes){
    List<Dish> healthDishes = new ArraryList<>();
    for(Dish dish: dishes){
        if(dish.getCalories()<1000){
            healthDishes.add(dish)
        }
    }
}
```
åæ¥åŒ»ç”Ÿè¯´ï¼Œä¸åªå¡è·¯é‡Œè¦ä½ï¼Œè€Œä¸”è‚‰å°±ä¸è¦åƒäº†ï¼Œåƒç´ æ¯”è¾ƒæœ‰åˆ©äºå¥åº·ï¼Œäºæ˜¯å«æ³ªå†™äº†ä»¥ä¸‹ä»£ç ï¼š

```java
public static List<Dish> filterDish(List<Dish> dishes){
    List<Dish> healthDishes = new ArraryList<>();
    for(Dish dish: dishes){
        if(dish.getCalories()<1000 && dish.getVegerarian()){
            healthDishes.add(dish)
        }
    }
}
```

ä¸èƒ½åƒè‚‰å“ªæ†‹å¾—ä½ï¼Œäºæ˜¯åŒ»ç”Ÿåˆè¯´ä½ å¯ä»¥åƒä¸€ç‚¹é±¼ã€‚æœ€ä¸ºä¸€ä¸ªæœ‰éª¨æ°”çš„ç¨‹åºå‘˜ï¼Œå·²ç»ä¸æƒ³å»è¿åˆ~~ï¼ˆäº§å“ç»ç†äº†ï¼‰~~åŒ»ç”Ÿå»ä¿®æ”¹ä»£ç äº†ï¼Ÿæœ‰æ²¡æœ‰ä»€ä¹ˆåŠæ³•ï¼Œèƒ½å¿«é€Ÿæ‰¾å‡ºå¥åº·é£Ÿç‰©ï¼Œä¸‡ä¸€å“ªå¤©å‡è‚¥æˆåŠŸäº†ï¼Œåˆèƒ½åƒè‚‰äº†ä¹Ÿä¸ç”¨å»ä¿®æ”¹ä»£ç ï¼Ÿ
äºæ˜¯æˆ‘ä»¬å†™è¿™æ ·ä¸€æ®µä»£ç ï¼š

```java
public static List<Dish> filterDish(List<Dish> dishes,int calorites,boolean isMeat,Type type){
    List<Dish> healthDishes = new ArraryList<>();
    for(Dish dish: dishes){
        if(dish.getCalories()<calorites 
            && dish.getVegerarian() == isMeat
            && dish.getType() == type ){
            healthDishes.add(dish)
        }
    }
}
```

éœ€æ±‚æ˜¯æ»¡è¶³äº†ï¼Œä½†æ˜¯ä½œä¸ºä¸€ä¸ªæœ‰å“ä½çš„ç¨‹åºå‘˜è‚¯å®šä¸å…è®¸è¿™æ ·ä»£ç å‡ºç°ï¼Œå®åœ¨è¿‡äºç¹çäº†ã€‚ä¸‡ä¸€å†åŠ å…¥ä¸€ä¸ªæ¡ä»¶æ€ä¹ˆåŠï¼Ÿ
æˆ‘ä»¬å¯ä»¥è€ƒè™‘å°†åŒ»ç”Ÿçš„åŒ»å˜±ä½œä¸ºä¸€ä¸ªæ–¹æ³•ä¼ å…¥æˆ‘ä»¬çš„filerDishè¿™ä¸ªæ–¹æ³•ï¼ŒåŒ»ç”Ÿè¯´å•¥å°±æ˜¯å•¥ï¼Œä¸å¿…è¦è‡ªå·±å°è£…ä¸€ä¸ªæ–¹æ³•æ¥å“åº”åŒ»ç”Ÿçš„è¦æ±‚ï¼Ÿäºæ˜¯æˆ‘ä»¬è¿™ä¹ˆè€ƒè™‘:

é¦–å…ˆè§„å®šä¸€ä¸ªæ¥å£å«â€åŒ»ç”Ÿè¯´â€ï¼š

```java
public interface DoctorSaid{
    boolean test(Dish dish);
}
```

æˆ‘ä»¬æŒ‘é€‰èœå“çš„æ—¶å€™è¿™æ ·å†™ï¼š

```java
public static List<Dish> filterDish(Dish dishes,DoctorSaid doctorSaid){
    List<Dish> lowCaloriesDishes = new ArraryList<>();
    for(Dish dish: dishe){
        if(doctorSaid.test(dish) ){
            healthDishes.add(dish)
        }
    }
}
```

å¦‚æœåŒ»ç”Ÿè¯´åƒ 1000 å¡è·¯é‡Œä¸€ä¸‹çš„é£Ÿç‰©ï¼Œæˆ‘ä»¬å®ç°ä¸€ä¸ª1000 ä»¥ä¸‹å¡è·¯é‡Œçš„é£Ÿç‰©ï¼š

```java
public boolean DoctorSaidLowCalorites implements DoctorSaid{
    boolean test(Dish dish){
        return dish.getCalorites() < 1000;
    }
}
```

è¿™æ ·æˆ‘ä»¬åªç”¨è¿™æ ·è°ƒç”¨filterDishå°±è§£å†³é—®é¢˜äº†ï¼š

```java
List<Dish> dishes = filterDish(dishes,new DoctorSaidLowCalorites());
```

é—®é¢˜æ¥äº†ï¼Œå¯¹äºå–„å˜çš„~~ï¼ˆäº§å“ç»ç†ï¼‰~~ åŒ»ç”Ÿï¼Œæ€»æ˜¯ä¸èƒ½æå‰å‡†å¤‡å¥½æ‰€æœ‰çš„æ¥å£å®ç°ï¼Ÿ
è¿™ä¸ªæ—¶å€™æˆ‘ä»¬å°±å¯ä»¥ä½¿ç”¨`JAVA`çš„åŒ¿åäº†å†…éƒ¨ç±»æ¥ä½¿ç”¨è¿™ä¸ªæŒ‘é€‰èœå“çš„æ–¹æ³•æ›´åŠ çµæ´»ã€‚äºæ˜¯æˆ‘ä»¬å°±æœ‰è¿™æ ·çš„ä»£ç äº†

```java 
List<Dish> dishes = filterDish(dishes,new DoctorSaid(){
    return dish.getCalorites() < 1000;
});
```

ç¨å¾®å¥½äº†ä¸€ç‚¹ï¼Œä½†æ˜¯åŒ¿åå†…éƒ¨ç±»è¿˜æ˜¯æœ‰ä¸€ä¸ªä¸å¥½çš„åœ°æ–¹ï¼Œå°±æ˜¯å¤ªå•°å—¦äº†å…¶å®æ ¸å¿ƒä»£ç å°±æ˜¯`dish.getCalorites() < 1000` ä¸ºä»€ä¹ˆæˆ‘ä»¬è¦å†™é‚£ä¹ˆå¤šä»£ç ï¼Ÿè¿™ä¸ªä¹Ÿæ˜¯javaè€è¢«è¯Ÿç—…çš„åœ°æ–¹,ä»£ç ååˆ†ç¹çã€‚
ç»ˆäºæˆ‘ä»¬çš„Lambdaè¡¨è¾¾å¼è¦å‡ºåœºäº†ï¼š

```java
List<Dish> dishes = filterDish(dishes, (Dish dish)-> dish.getCalorites() < 1000);
```

ç°åœ¨çœ‹ä¸Šå»å¥½å¤šäº†ï¼Œä½†æ˜¯ä½œä¸ºä¸€ä¸ªç¨‹åºå‘˜è¿˜æ˜¯å¾ˆè´ªå¿ƒå•Šï¼Œç°åœ¨åªèƒ½è¿‡æ»¤ `Dish` èƒ½ä¸èƒ½å†æŠ½è±¡ä¸€ç‚¹å‘¢ï¼Ÿå½“ç„¶å•Šï¼Œçœ‹è¿™ä¸ªï¼š

```java
public interface Predicate<T>{
    boolean test(T t);
}

public static <T> List<T> filter(List<T> list, Predicate<T> p){
    List<T> result = new ArrayList<>();
    for(T e: list){
        if(p.test(e)){
            result.add(e);
        }
    }
    return result;
}
```

ä½¿ç”¨æ³›å‹è®©æˆ‘ä»¬çš„ä»£ç æ›´åŠ é€šç”¨ã€‚éšä¾¿äº§å“ç»ç†æ”¹éœ€æ±‚ï¼Œä» List é‡Œé¢æŒ‰è§„åˆ™è¿‡æ»¤ç¬¦åˆè¦æ±‚çš„éœ€æ±‚ä¸ç”¨å¤šå†™ä»£ç éƒ½èƒ½æå®šäº†ã€‚è¿™æ—¶å€™ä½ æ˜¯ä¸æ˜¯è§‰å¾—èƒ¸å‰çš„çº¢é¢†å·¾æ›´åŠ é²œè‰³äº†ï¼Ÿ

## 2. å®é™…åº”ç”¨ï¼š

ä½œä¸ºä¸€ä¸ªæ‹›è˜ç½‘ç«™çš„ç¨‹åºå‘˜ï¼Œä¸€å®šæœ‰å¾ˆå¤šå°†èŒä½åˆ—è¡¨æ’åºçš„éœ€æ±‚ï¼Œæ¯”å¦‚æŒ‰ç…§æ›´æ–°æ—¶é—´å°†èŒä½åˆ—è¡¨æ’åºæˆ‘ä»¬å¯ä»¥è¿™ä¹ˆå†™ï¼š

```java

jobList.sort((JobInfo job1,JobInfo job2)->job1.getUpdateTime.compareTo(job2.getUpdateTime);

```

æˆ–è€…ä½œä¸ºé«˜ç«¯ç¨‹åºå‘˜çš„å¤šçº¿ç¨‹å¯ä»¥è¿™æ ·å†™ï¼š

```java
    Thread t = new Thread(()-> System.out.println("Hello world"));
```

## 3. è¿‘è·ç¦»è§‚å¯ŸLambda
### 1. ä»€ä¹ˆæ˜¯Lambda
æ‰€ä»¥é€šè¿‡ä¸Šé¢ä¾‹å­æˆ‘ä»¬å°è¯•å®šä¹‰ä¸€ä¸‹Lambda è¡¨è¾¾å¼æ˜¯ä»€ä¹ˆï¼Ÿ

Lambdaè¡¨è¾¾å¼ä¸ºç®€æ´çš„è¡¨ç¤ºå¯ä¼ é€’çš„åŒ¿åå‡½æ•°çš„è¡¨è¾¾å¼çš„ä¸€ç§æ–¹å¼ã€‚åˆ†å¼€æ¥è¯´ï¼š 

* åŒ¿åï¼šæ²¡æœ‰å¿…è¦ç»™ä»–å–ä¸€ä¸ªå‡½æ•°åç§°ã€‚
* ç®€æ´ï¼šç›¸å¯¹äºåŒ¿åå†…éƒ¨å†…ä¸éœ€è¦å†™å¾ˆå¤šæ¨¡æ¿ä»£ç 
* ä¼ é€’ï¼šå¯ä»¥åšä¸ºå‚æ•°ä¼ é€’ç»™æ–¹æ³•
* å‡½æ•°ï¼šä¸å±ç‰¹å®šç±»ã€‚ä½†æ˜¯å’Œæ–¹æ³•ä¸€æ ·ï¼Œæœ‰å‚æ•°ï¼Œå‡½æ•°ä¸»é¢˜ï¼Œè¿”å›å€¼ï¼Œæœ‰æ—¶å€™è¿˜èƒ½æŠ›å¼‚å¸¸ã€‚

æ ‡å‡†çš„Lambdaè¡¨è¾¾å¼:

```
(Dish dish) -> dish.getCalories() > 1000;
```

ä»ä¸Šé¢çš„æ ‡å‡†çš„è¡¨è¾¾å¼ï¼šä¸€å…±ä¸‰ä¸ªéƒ¨åˆ†ç»„æˆ
    * å‚æ•°ï¼š
    * ç®­å¤´ï¼š
    * Lamdbaä¸»ä½“ï¼šä¹Ÿå°±æ˜¯å‡½æ•°çš„ä¸»ä½“

### 2. ä»€ä¹ˆæ—¶å€™ä½¿ç”¨Lambda
* å‡½æ•°å¼æ¥å£ï¼š

æ‰€è°“å‡½æ•°å¼æ¥å£ï¼Œæˆ‘ä»¬å¯ä»¥ç†è§£ä¸ºå°±æ˜¯åªæœ‰ä¸€ä¸ªæ–¹æ³•çš„æ¥å£ã€‚

* å‡½æ•°æè¿°ç¬¦ï¼š

å‡½æ•°å¼æ¥å£çš„ç­¾ååŸºæœ¬ä¸Šå°±æ˜¯Lambdaè¡¨è¾¾å¼çš„ç­¾åã€‚æˆ‘ä»¬é™è¿™ç§æŠ½è±¡æ–¹æ³•å«åšå‡½æ•°æè¿°ç¬¦ã€‚ä¸¾ä¸ªä¾‹å­ï¼ŒRuannable æ–¹æ³•å°±å¯ä»¥çœ‹åšä¸€ä¸ªä»€ä¹ˆéƒ½ä¸æ¥å—ï¼Œä»€ä¹ˆéƒ½ä¸è¿”å›çš„å‡½æ•°ã€‚è¿™ä¸ªæ—¶å€™æˆ‘ä»¬å¯ä»¥å‘ç°ä¼ å…¥çš„ Lambda å‡½æ•°ä¸º `()->void`.

### 3. Lambdaçš„ç±»å‹æ¨æ–­

Javaç¼–è¯‘å™¨ä¼šæ ¹æ®ä¸Šä¸‹æ–‡æ¨æ–­ä½¿ç”¨ä»€ä¹ˆå‡½æ•°å¼æ¥å£æ¥é…åˆLambdaè¡¨è¾¾å¼ï¼Œæ¯”å¦‚æˆ‘ä»¬ä¹‹å‰çš„ä¾‹å­ï¼Œä»¥ä¸‹ä¸¤ç§å†™æ³•éƒ½æ˜¯æ­£ç¡®çš„ï¼š

```java
(Dish dish) -> dish.getCalories() > 1000;

dish -> dish.getCalories() > 1000;
``` 

ç¬¬äºŒä¸ªè¯­å¥å¹¶æ²¡æœ‰æ˜¾å¼çš„åˆ¶å®š```dish```çš„ç±»å‹æ˜¯```Dish```ï¼Œç¼–è¯‘å™¨ä¹Ÿèƒ½æ­£ç¡®çš„ç¼–è¯‘ä»£ç ã€‚

### 4.æ–¹æ³•çš„å¼•ç”¨

åœ¨Lambdaä¸­æˆ‘ä»¬å¯ä»¥åˆ©ç”¨æ–¹æ³•çš„å¼•ç”¨æ¥é‡å¤ä½¿ç”¨ã€‚å¯ä»¥è®¤ä¸ºæ˜¯ä¸€ä¸ªLamdbaå¸¦æ¥çš„è¯­æ³•ç³–ğŸ¬ã€‚

å¯¹äºä¹‹å‰æˆ‘ä»¬ä¸ºèŒä½æ’åºçš„ä¾‹å­ï¼š

```java
jobList.sort((JobInfo job1,JobInfo job2)->job1.getUpdateTime.compareTo(job2.getUpdateTime);
```

æˆ‘ä»¬å¯ä»¥æ”¹å†™ä¸º

```java
jobList.sort(comparing(JobInfo::getUpdateTime));
```

åæ­£æˆ‘ç¬¬ä¸€æ¬¡çœ‹åˆ°è¿™ç§å†™æ³•ä¹Ÿä¸ç¦æ„Ÿå¹ï¼Œè¿™ä¹Ÿè¡Œï¼Ÿè¿˜æœ‰è¿™ç§æ“ä½œï¼Ÿ

æˆ‘ä»¬å°±æ¥çœ‹çœ‹ JDK 8 ä¸­å¯¹äºæ–¹æ³•çš„å¼•ç”¨æœ‰ä»¥ä¸‹å››ç§ç±»å‹ï¼š

* static é™æ€æ–¹æ³•çš„å¼•ç”¨ï¼Œè¿™ä¸ªæ²¡å•¥å¥½è¯´çš„ï¼Œè¯­æ³•å°±æ˜¯ ```(ClassName:staticMethod)```ã€‚

* ä»»æ„ç±»å‹çš„å®ä¾‹æ–¹æ³•çš„å¼•ç”¨ï¼Œæ¯”å¦‚ String æ–¹æ³•çš„ length æ–¹æ³•ï¼š

```java
(String s1) -> s1.length()

(String::length)
```

* ç°æœ‰å¯¹è±¡çš„å®ä¾‹æ–¹æ³•çš„å¼•ç”¨ï¼š

```java
()-> s.length()

(s::length)
```

* æ„é€ å‡½æ•°çš„å¼•ç”¨ï¼šç›´æ¥ä¸Šä»£ç ä¹Ÿå¾ˆå¥½ç†è§£```(Dish::new)```ã€‚

#### 5.ç°æˆçš„å‡½æ•°å¼æ¥å£

JDK 8 ä¸­å·²ç»åŒ…å«äº†è‹¥å¹²ç°æˆçš„å‡½æ•°å¼æ¥å£ã€‚åœ¨```java.util.function```ä¸­ã€‚åŒ…æ‹¬```Predicate<T>```ï¼Œ```Function<T,R>```ï¼Œ```Consumer<T>```ã€‚å¤§å®¶å¯ä»¥ç›´æ¥æŸ¥çœ‹æºç ï¼Œåœ¨è¿™é‡Œå°±ä¸è®²è§£äº†ã€‚


ç¬¬ä¸€éƒ¨åˆ†æ•™ç¨‹ç»“æŸäº†ï¼Œè¯·å¤§å®¶æœŸå¾…ã€ŠJAVA 8å…¥é—¨ï¼ˆäºŒï¼‰ æ•°æ®æµçš„æ“ä½œã€‹